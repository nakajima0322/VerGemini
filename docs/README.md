# 部品管理・工程追跡システム ドキュメント

## 1. 概要 (Overview)

本システムは、製造業における部品の調達から工程完了までのステータスを、バーコードスキャンによって追跡・管理することを目的としたツール群です。

主な機能は以下の通りです。

- **部品の入荷管理**: 発注した部品が工場に納品されたことを記録します。
- **工程管理**: 部品を特定の加工工程（メッキ、塗装など）に出したことを記録します。
- **進捗の可視化**: 工事番号ごとに、未納品の部品や、工程に出したままの部品（仕掛品）を一覧で確認できます。
- **データ照合と修正**: スキャンしたデータと発注データを照合したり、間違って登録したデータを修正したりできます。

---

## 2. システム構成 (System Architecture)

本システムは、複数の独立した Python ツールが連携して動作します。各ツールのハブとなるのが `G_Launcher.py` です。

### 主要ツール一覧

| ツール名 (ファイル名)                                 | 主な役割                                                                       |
| :---------------------------------------------------- | :----------------------------------------------------------------------------- |
| **ツールランチャー** (`G_Launcher.py`)                | 全てのツールを起動するためのハブ。作業者の選択もここで行う。                   |
| **保管場所登録スキャン** (`G_ScanBCD_main.py`)        | 部品が工場内の**どこに**あるかを記録する。入荷した部品の最初のスキャンで使用。 |
| **工程登録スキャン** (`G_ProcessSorter.py`)           | 部品を**どの工程に**出したかを記録する。                                       |
| **保管場所照合ツール** (`G_DrawingNumberViewer.py`)   | スキャンした部品と発注データを照合し、保管場所ごとの在庫状況を確認する。       |
| **部品情報表示ツール** (`G_PartInfoViewer.py`)        | 特定のバーコード（発注伝票 №）に紐づく詳細な部品情報を表示する。               |
| **ワークフロー管理** (`G_WorkflowManager.py`)         | 工事全体の進捗（未納品、仕掛品）を一覧表示するダッシュボード。                 |
| **データビューア/エディタ** (`G_DataViewerEditor.py`) | スキャンによって生成された CSV ファイルの内容を直接表示・編集する。            |
| **設定エディタ** (`G_ConfigEditor.py`)                | `config.json` ファイル内の各種設定値を GUI で安全に編集する。                  |
| **結合 CSV 作成** (`create_combined_csv.py`)          | 各データソースを結合し、最終的なレポート CSV を生成する。                      |

---

## 3. データ構造 (Data Structure)

システムの動作は、主に以下のファイルによって管理されます。

- **`config.json`**
  **システム全体の動作設定を定義するファイル。カメラ設定、CSV のカラム名、各種リスト（工程、業者）などが含まれます。
  ** 各ツールのウィンドウ位置や前回値などもこのファイルに自動で保存されます。

- **`Source/` フォルダ**
  \*\* **`{工事番号}s.csv`**: 発注情報が記載されたマスターデータ。各部品の図番、品名、仕入先などの情報が含まれます。

- **`data/` フォルダ** \***\*`{工事番号}.csv`**: 「保管場所登録スキャン」によって生成されるデータ。部品が**どの保管場所にあるか**が記録されます。
  \*\* **`{工事番号}_processed.csv`**: 「工程登録スキャン」によって生成されるデータ。部品が**どの工程に出されたか**が記録されます。
  \*\* **`{工事番号}result.csv`**: 「結合 CSV 作成」ツールによって生成される最終レポート。
  \*\* **`sequences.json`**: バーコードがない部品にユニーク ID を払い出す際の連番を管理します。

- **`log/` フォルダ**
  \*\*\* 各種操作ログが保存されます。

---

## 4. 基本的な運用フロー (Basic Workflow)

1. **起動**:
   \*\*\* `G_Launcher.py` を実行してランチャーを起動します。

2. **作業者選択**:
   \*\*\* ランチャーに表示されるリストから、作業を行う担当者を選択します。

3. **部品の入荷処理**:
   **\*仕入先から部品が納品されたら、「**保管場所登録スキャン**」を起動します。 \*** 保管場所（例: `棚`, `コンテナ`）を選択し、部品のバーコード（発注伝票 №）をスキャンします。
   \*\*\* これにより、`data/{工事番号}.csv` に「どの部品が、どの保管場所にあるか」が記録されます。

4. **部品の工程投入処理**:
   **\*部品を外部の加工業者へ送る際に、「**工程登録スキャン**」を起動します。 \*** 「納品業者」と「工程名」（例: `メッキ`, `塗装`）を選択し、対象部品のバーコードをスキャンします。
   \*\*\* これにより、`data/{工事番号}_processed.csv` に「どの部品が、どの工程に出されたか」が記録されます。

5. **進捗確認と照合**:
   **\*「**ワークフロー管理**」ツールで、未納品の部品や、工程に出したまま戻ってきていない部品（仕掛品）を確認します。 \*** 「**保管場所照合ツール**」で、発注データとスキャンデータを照合し、在庫状況を確認します。

6. **データ修正**:
   **\* スキャンミスなど、記録を修正したい場合は「**データビューア/エディタ\*\*」を使用します。

---

## 5. 開発方針 (Development Policy)

現在、実際のデータ収集を開始しているため、今後の開発は以下の点を最優先とします。

1. **データ収集機能の安定性**:
   \*\*\* データ入力のコア機能（保管場所登録、工程登録）の安定性を最優先し、不用意な変更は避けます。

2. **データ形式の互換性**:
   \*\* CSV ファイルのフォーマットを変更する際は、古いデータも読み込める後方互換性を維持します。

3. **新機能のモジュール化**:
   \*\* 新しい機能は、既存のデータ収集機能から独立したツールとして開発し、システム全体への影響を最小限に抑えます。

4. **プロトタイピングによる機能具体化**:
   \*\* まずはプロトタイプとして各機能を実装し、実際の使い勝手を確認しながら、統合や改善を進めて最終的なシステムを構築します。

---

_最終更新日: 2025-12-04
